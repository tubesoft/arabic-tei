import{p as D,u as z,q as d,v as B,x as M,s as X,y as I,f as h,a as l,c as i,w as n,z as N,m as _,n as k,A as F,o as s,B as m,C as S,g as b,D as v,E as O,G as U,F as j,r as G,H,e as q,t as L,I as J}from"./index-T0yj2KUD.js";const W={__name:"Edition",props:{edList:Array},setup(V){const C=I();D(()=>{const e=z();e.query.xsl&&e.query.xml&&(g(e.query.xsl,e.query.xml),r.value=!0)});const p=B(),R=d(p.global.name.value==="dark");M(()=>R.value,e=>{p.global.name.value=e?"dark":"light"});const f=X(k({template:"<div></div>"}));let y="",x="",a={};const w=d(!0),r=d(!1);async function A(){try{const t=await(await fetch(`/arabic-tei/tei/${y}.xml`)).text(),u=await(await fetch(`/arabic-tei/xslt/${x}.sef.json`)).text();try{const c={stylesheetText:u,sourceText:t,destination:"application"};a=(await SaxonJS.transform(c,"async")).principalResult}catch(c){throw console.error(c),new Error("ERROR in converting")}for(;a.querySelector("#vslot");)a.querySelector("#vslot").setAttribute("v-slot:activator","{ props }"),a.querySelector("#vslot").removeAttribute("id");for(;a.querySelector("#v-menu-config");)a.querySelector("#v-menu-config").setAttribute(":nudge-width","150"),a.querySelector("#v-menu-config").setAttribute(":close-on-content-click","false"),a.querySelector("#v-menu-config").removeAttribute("id");const $=new XMLSerializer().serializeToString(a).replaceAll("template-to-be","template");f.value=T($)}catch(e){throw console.error(e),new Error("ERROR in rendering")}}function E(e,t){y=t,x=e,A()}function g(e,t){C.push({path:"edition",query:{xsl:e,xml:t}}),E(e,t)}function T(e){return k({components:{components:F},template:e})}return(e,t)=>(s(),h("div",null,[l(N,{modelValue:w.value,"onUpdate:modelValue":t[3]||(t[3]=o=>w.value=o),class:"sticky-menu",permanent:"",rail:r.value},{default:n(()=>[l(S,{"min-height":"60"},{append:n(()=>[r.value?m("",!0):(s(),i(b,{key:0,density:"compact",flat:"",icon:"mdi-chevron-left",onClick:t[1]||(t[1]=v(o=>r.value=!r.value,["stop"]))}))]),default:n(()=>[r.value?(s(),i(b,{key:0,class:"ml-1 mb-2",density:"compact",flat:"",icon:"mdi-chevron-right",onClick:t[0]||(t[0]=v(o=>r.value=!r.value,["stop"]))})):m("",!0)]),_:1}),l(O),r.value?m("",!0):(s(),i(U,{key:0,dense:""},{default:n(()=>[(s(!0),h(j,null,G(V.edList,o=>(s(),i(S,{key:o.title,disabled:r.value,link:"","prepend-icon":"mdi-book-open-variant",onClick:[u=>g(o.xsl,o.xml),t[2]||(t[2]=v(u=>r.value=!r.value,["stop"]))]},{default:n(()=>[l(H,null,{default:n(()=>[q(L(o.title),1)]),_:2},1024),l(J,null,{default:n(()=>[q(L(o.author),1)]),_:2},1024)]),_:2},1032,["disabled","onClick"]))),128))]),_:1}))]),_:1},8,["modelValue","rail"]),(s(),i(_(f.value)))]))}};export{W as default};

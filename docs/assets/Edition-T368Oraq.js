import{o as D,u as z,r as m,a as M,w as X,s as B,b as N,c as h,d as l,e as i,f as o,V as _,g as I,h as k,i as j,j as s,k as d,l as S,m as b,n as p,p as F,q as O,F as U,t as J,v as G,x as V,y as L,z as H}from"./index-cNpdaeBW.js";const W={__name:"Edition",props:{edList:Array},setup(R){const C=N();D(()=>{const e=z();e.params.xsl&&e.params.xml&&(g(e.params.xsl,e.params.xml),a.value=!0)});const v=M(),q=m(v.global.name.value==="dark");X(()=>q.value,e=>{v.global.name.value=e?"dark":"light"});const f=B(k({template:"<div></div>"}));let x="",y="",n={};const w=m(!0),a=m(!1);async function T(){try{const t=await(await fetch(`/arabic-tei/tei/${x}.xml`)).text(),u=await(await fetch(`/arabic-tei/xslt/${y}.sef.json`)).text();try{const c={stylesheetText:u,sourceText:t,destination:"application"};n=(await SaxonJS.transform(c,"async")).principalResult}catch(c){throw console.error(c),new Error("ERROR in converting")}for(;n.querySelector("#vslot");)n.querySelector("#vslot").setAttribute("v-slot:activator","{ props }"),n.querySelector("#vslot").removeAttribute("id");for(;n.querySelector("#v-menu-config");)n.querySelector("#v-menu-config").setAttribute(":nudge-width","150"),n.querySelector("#v-menu-config").setAttribute(":close-on-content-click","false"),n.querySelector("#v-menu-config").removeAttribute("id");const E=new XMLSerializer().serializeToString(n).replaceAll("template-to-be","template");f.value=A(E)}catch(e){throw console.error(e),new Error("ERROR in rendering")}}function $(e,t){x=t,y=e,T()}function g(e,t){C.push({name:"edition-rendition",params:{xsl:e,xml:t}}),$(e,t)}function A(e){return k({components:{components:j},template:e})}return(e,t)=>(s(),h("div",null,[l(_,{modelValue:w.value,"onUpdate:modelValue":t[3]||(t[3]=r=>w.value=r),class:"sticky-menu",permanent:"",rail:a.value},{default:o(()=>[l(S,{"min-height":"60"},{append:o(()=>[a.value?d("",!0):(s(),i(b,{key:0,density:"compact",flat:"",icon:"mdi-chevron-left",onClick:t[1]||(t[1]=p(r=>a.value=!a.value,["stop"]))}))]),default:o(()=>[a.value?(s(),i(b,{key:0,class:"ml-1 mb-2",density:"compact",flat:"",icon:"mdi-chevron-right",onClick:t[0]||(t[0]=p(r=>a.value=!a.value,["stop"]))})):d("",!0)]),_:1}),l(F),a.value?d("",!0):(s(),i(O,{key:0,dense:""},{default:o(()=>[(s(!0),h(U,null,J(R.edList,r=>(s(),i(S,{key:r.title,disabled:a.value,link:"","prepend-icon":"mdi-book-open-variant",onClick:[u=>g(r.xsl,r.xml),t[2]||(t[2]=p(u=>a.value=!a.value,["stop"]))]},{default:o(()=>[l(G,null,{default:o(()=>[V(L(r.title),1)]),_:2},1024),l(H,null,{default:o(()=>[V(L(r.author),1)]),_:2},1024)]),_:2},1032,["disabled","onClick"]))),128))]),_:1}))]),_:1},8,["modelValue","rail"]),(s(),i(I(f.value)))]))}};export{W as default};
